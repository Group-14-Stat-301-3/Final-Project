---
title: "Feature Extraction & Data Splitting"
author: "Zach Kornbluth, Albert Kim, Jordi Parry"
date: "6/7/2021"
output: html_document
---

## Load Packages/Data

```{r load-packages}
library(tidyverse)
library(tidymodels)
mlb_train <- read_csv("training_data_mlb.csv")
```

## Feature Extraction

To begin, we added our target variable `ops` and all predictors to the recipe. As noted in our EDA, there are a few variables that highly correlate with one another. Due to this, we chose to remove `z_swing_miss_pct` and `oz_swing_miss_pct` from the recipe. In addition, given the skewness we noticed in `b_bb_pct`, `barrel_batted_rate`, and `oz_contact_pct`, we chose to log transform those variables. We also included an offset of `1e-16` to handle values of 0, which we noticed in `barrel_batted_rate`. Finally, we normalized all predictors.

Below is our recipe, which contains the steps outlined above.

```{r}
mlb_recipe <- recipe(ops ~ ., data = mlb_train) %>%
  step_rm(z_swing_miss_pct, oz_swing_miss_pct) %>%
  step_log(b_bb_pct, barrel_batted_rate, oz_contact_pct, offset = 1e-16) %>%
  step_normalize(all_predictors())
```

## Data Split

We used a 75/25 split on the dataset to create the training and testing subsets. The training subset contains 573 observations while the testing subset contains 188 observations. We also stratified by the outcome variable `ops`.